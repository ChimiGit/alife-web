---
// Universal language switching script component
---

<script is:inline>
(function() {
	// Get language from URL parameters
	const urlParams = new URLSearchParams(window.location.search);
	const lang = urlParams.get('lang') || 'en';

	// Update language selector active state
	const enLink = document.querySelector('a[href="?lang=en"]');
	const jpLink = document.querySelector('a[href="?lang=jp"]');
	
	if (enLink && jpLink) {
		if (lang === 'jp') {
			// JP is active
			enLink.classList.remove('text-accent-cyan');
			enLink.classList.add('text-primary');
			jpLink.classList.remove('text-primary');
			jpLink.classList.add('text-accent-cyan');
		} else {
			// EN is active (default)
			jpLink.classList.remove('text-accent-cyan');
			jpLink.classList.add('text-primary');
			enLink.classList.remove('text-primary');
			enLink.classList.add('text-accent-cyan');
		}
	}

	// Apply Japanese translations if selected
	if (lang === 'jp') {
		// Load Japanese translations
		fetch('/jp.json')
			.then(response => response.json())
			.then(jpTranslations => {
				// Helper function to translate text
				function translate(text) {
					return jpTranslations[text] || text;
				}

				// Helper function to find elements by text content
				function findElementByText(selector, text) {
					const elements = document.querySelectorAll(selector);
					for (let el of elements) {
						if (el.textContent.includes(text)) {
							return el;
						}
					}
					return null;
				}

				// Update page title
				const titleElement = document.querySelector('title');
				const currentPath = window.location.pathname;
				if (titleElement) {
					if (currentPath === '/about') {
						titleElement.textContent = `${translate('About Us')} - ALIFE`;
					} else if (currentPath === '/career') {
						titleElement.textContent = `${translate('Career')} - ALIFE`;
					} else if (currentPath === '/support') {
						titleElement.textContent = `${translate('Support Us')} - ALIFE`;
					} else if (currentPath === '/blog') {
						titleElement.textContent = `${translate('Blog')} - ALIFE`;
					}
				}

				// Update navigation links
				const aboutLink = document.querySelector('a[href*="/about"]');
				if (aboutLink) {
					aboutLink.textContent = translate('About');
					aboutLink.href = `/about?lang=${lang}`;
				}

				const careerLink = document.querySelector('a[href*="/career"]');
				if (careerLink) {
					careerLink.textContent = translate('Career');
					careerLink.href = `/career?lang=${lang}`;
				}

				const blogLink = document.querySelector('a[href*="/blog"]');
				if (blogLink) {
					blogLink.textContent = translate('Blog');
					blogLink.href = `/blog?lang=${lang}`;
				}

				const supportLink = document.querySelector('a[href*="/support"]');
				if (supportLink) {
					supportLink.textContent = translate('Support Us');
					supportLink.href = `/support?lang=${lang}`;
				}

				// Update homepage content if on homepage
				if (currentPath === '/') {
					// Update page title lines
					const titleElements = document.querySelectorAll('h1');
					if (titleElements[0]) titleElements[0].textContent = translate('Where');
					if (titleElements[1]) titleElements[1].textContent = translate('Evolution Meets');
					if (titleElements[2]) titleElements[2].textContent = translate('Innovation');

					// Update description
					const descriptionElement = document.querySelector('p');
					if (descriptionElement) {
						descriptionElement.textContent = translate('We\'re cultivating alternative approaches through evolution itself—creating systems that don\'t just optimize, but discover, surprise, and continuously evolve. This is where we pave a way for a future not engineered, but grown organically through bottom-up ecosystems where humans and artificial life forms collaborate as complementary partners.');
					}
				}

				// Update page-specific content
				if (currentPath === '/about') {
					// Update About page tabs by their actual IDs
					const aboutTab = document.querySelector('#tabs-with-underline-item-1');
					const historyTab = document.querySelector('#tabs-with-underline-item-2');
					const missionTab = document.querySelector('#tabs-with-underline-item-3');
					
					if (aboutTab) aboutTab.textContent = translate('About');
					if (historyTab) historyTab.textContent = translate('History');
					if (missionTab) missionTab.textContent = translate('Mission');

					// Update loading screen text
					const loadingText = document.querySelector('#loading-screen .text-200px');
					if (loadingText) loadingText.textContent = translate('About Us');

					// Update History component content
					const historyTitle = findElementByText('h2', 'History');
					if (historyTitle) historyTitle.textContent = translate('History');

					const historySubtitle = findElementByText('span', 'Why Us');
					if (historySubtitle) historySubtitle.textContent = translate('Why Us ? We are already well positioned to succeed.');

					// Update Mission component content
					const missionTitle = findElementByText('h1', 'Mission');
					if (missionTitle && !missionTitle.textContent.includes('Values')) {
						missionTitle.textContent = translate('Mission');
					}

					const visionTitle = findElementByText('h1', 'Vision');
					if (visionTitle) visionTitle.textContent = translate('Vision');

					const valuesTitle = findElementByText('h2', 'Values');
					if (valuesTitle) valuesTitle.textContent = translate('Values');

					// Update WhoWeAre content
					const whoWeAreTitle = findElementByText('h2', 'Who We Are');
					if (whoWeAreTitle) whoWeAreTitle.textContent = translate('Who We Are');

					// Update mission content paragraphs
					const missionContent = findElementByText('p', 'To cultivate symbiotic');
					if (missionContent) {
						missionContent.textContent = translate('To cultivate symbiotic relationships between humans and artificial life through open-ended evolutionary systems that continuously generate novel solutions to complex real-world challenges.');
					}

					const visionContent = findElementByText('p', 'A future where artificial life');
					if (visionContent) {
						visionContent.textContent = translate('A future where artificial life forms serve as creative partners to humanity, where evolution and intelligence work together to solve problems we cannot yet imagine, and where the boundary between natural and artificial creativity dissolves into collaborative innovation.');
					}

					// Update WhoWeAre paragraphs
					const whoWeAreParagraphs = document.querySelectorAll('p');
					whoWeAreParagraphs.forEach((p, index) => {
						if (p.textContent.includes('The Artificial Life Institute stands')) {
							p.textContent = translate('The Artificial Life Institute stands at the intersection of cutting-edge computer science and nature\'s most profound creative force: evolution. We don\'t follow predetermined paths like most traditional AIs. Instead, we harness open-endedness—nature\'s grandest achievement that created a path from single cells to intelligent life, from the discovery of fire to exploring outer space, from primitive tools to artificial intelligence.');
						} else if (p.textContent.includes('Founded by world-class researchers')) {
							p.textContent = translate('Founded by world-class researchers and business leaders, we are dedicated to advancing research and driving business innovations. Our work spans from microscopic digital organisms to complex evolutionary simulations that could reshape how we understand intelligence itself.');
						} else if (p.textContent.includes('Based in Kyoto')) {
							p.textContent = translate('Based in Kyoto, we bring together brilliant minds who see beyond the current AI paradigm, building the foundation for a world where humans and artificial life forms co-evolve, creating possibilities neither could achieve alone. For complete transparency about our operations and commitment to your privacy, please see our fiscal report and privacy policy.');
						}
					});

					// Update research project labels
					const researchLabels = document.querySelectorAll('p.text-orange-400');
					researchLabels.forEach(label => {
						const text = label.textContent.trim();
						label.textContent = translate(text);
					});

					// Update values list
					const valuesList = document.querySelectorAll('li');
					valuesList.forEach(item => {
						const text = item.textContent.trim();
						if (text.includes(':')) {
							item.textContent = translate(text);
						}
					});
				}

				if (currentPath === '/career') {
					// Update Career page hero content
					const heroTitle = findElementByText('h1', 'Where Brilliant');
					if (heroTitle) heroTitle.innerHTML = translate('Where Brilliant<br>Minds Explore Together');

					const heroDescription = findElementByText('p', 'Discover what happens');
					if (heroDescription) {
						heroDescription.textContent = translate('Discover what happens at the intersection of nature and computation, where we\'re creating something unprecedented. Our team combines world-class researchers and innovative engineers united by a shared fascination with emergence and open-ended discovery. Here, your expertise contributes to projects that grow organically, surprising even their creators.');
					}

					const joinUsTitle = findElementByText('h2', 'Join Us');
					if (joinUsTitle) joinUsTitle.textContent = translate('Join Us!');

					// Update tabs
					const ourTeamTab = document.querySelector('#our-team-tab');
					const jobsTab = document.querySelector('#jobs-tab');
					
					if (ourTeamTab) ourTeamTab.textContent = translate('Our Team');
					if (jobsTab) jobsTab.textContent = translate('Jobs');

					// Update loading screen text
					const loadingText = document.querySelector('#loading-screen .text-200px');
					if (loadingText) loadingText.textContent = translate('Career');

					// Update Team component content
					const teamTitle = findElementByText('h3', 'The Team');
					if (teamTitle) teamTitle.textContent = translate('The Team');

					// Update team tabs
					const executivesTab = document.querySelector('#executives-tab');
					const directorsTab = document.querySelector('#directors-tab');
					const researchersTab = document.querySelector('#researchers-tab');
					const adminTab = document.querySelector('#admin-tab');

					if (executivesTab) executivesTab.textContent = translate('Executives');
					if (directorsTab) directorsTab.textContent = translate('Directors');
					if (researchersTab) researchersTab.textContent = translate('Researchers');
					if (adminTab) adminTab.textContent = translate('Admin Team');

					// Update team member positions and job titles
					const allElements = document.querySelectorAll('p, h3');
					allElements.forEach(el => {
						const text = el.textContent.trim();
						const translation = translate(text);
						if (translation !== text) {
							el.textContent = translation;
						}
					});

					// Update buttons
					const buttons = document.querySelectorAll('button');
					buttons.forEach(button => {
						const text = button.textContent.trim();
						const translation = translate(text);
						if (translation !== text) {
							button.textContent = translation;
						}
					});
				}

				if (currentPath === '/support') {
					// Update Support page content
					const heroTitle = findElementByText('h1', 'Join the Evolution');
					if (heroTitle) heroTitle.textContent = translate('Join the Evolution');

					const heroDescription = findElementByText('p', 'Science advances');
					if (heroDescription) {
						heroDescription.textContent = translate('Science advances through community support. Your contribution helps fund breakthrough research that wouldn\'t be possible within traditional academic or corporate constraints. Our diverse team of world-class researchers and visionaries are exploring uncharted territory—and that requires resources, patience, and believers in long-term vision.');
					}

					const locationElement = findElementByText('p', 'Kyoto HQ');
					if (locationElement) locationElement.textContent = translate('Kyoto HQ, Japan');

					// Update loading screen text
					const loadingText = document.querySelector('#loading-screen .text-200px');
					if (loadingText) loadingText.textContent = translate('Support Us');
				}

				if (currentPath === '/blog') {
					// Update Blog page content
					const blogTitle = findElementByText('h1', 'Sharing Our Journey');
					if (blogTitle) blogTitle.textContent = translate('Sharing Our Journey');

					const blogDescription = findElementByText('p', 'Research breakthroughs');
					if (blogDescription) {
						blogDescription.textContent = translate('Research breakthroughs, upcoming events, and latest news from the frontier of evolutionary AI');
					}

					// Update loading screen text
					const loadingText = document.querySelector('#loading-screen .text-200px');
					if (loadingText) loadingText.textContent = translate('Blog');

					// Update tabs
					const overviewTab = document.querySelector('#overview-tab');
					const researchTab = document.querySelector('#research-tab');
					const eventsTab = document.querySelector('#events-tab');
					const newsTab = document.querySelector('#news-tab');

					if (overviewTab) overviewTab.textContent = translate('Overview');
					if (researchTab) researchTab.textContent = translate('Research');
					if (eventsTab) eventsTab.textContent = translate('Events');
					if (newsTab) newsTab.textContent = translate('News');

					// Update sidebar
					const researchTeamsTitle = findElementByText('h3', 'Research Teams');
					if (researchTeamsTitle) researchTeamsTitle.textContent = translate('Research Teams');

					// Update blog post titles and descriptions
					const postTitles = document.querySelectorAll('article h2');
					postTitles.forEach((title, index) => {
						const text = title.textContent.trim();
						const translation = translate(text);
						if (translation !== text) {
							title.textContent = translation;
						}
					});

					const postDescriptions = document.querySelectorAll('article p');
					postDescriptions.forEach(desc => {
						const text = desc.textContent.trim();
						const translation = translate(text);
						if (translation !== text && text.length > 50) {
							desc.textContent = translation;
						}
					});

					// Update Explore buttons
					const exploreButtons = document.querySelectorAll('button');
					exploreButtons.forEach(button => {
						if (button.textContent.trim() === 'Explore') {
							button.textContent = translate('Explore');
						}
					});
				}

				if (currentPath === '/privacy-policy') {
					// Update Privacy Policy content
					const privacyTitle = findElementByText('h1', 'Privacy Policy');
					if (privacyTitle) privacyTitle.textContent = translate('Privacy Policy');

					const instituteElement = findElementByText('h2', 'Artificial Life Institute');
					if (instituteElement) instituteElement.textContent = translate('Artificial Life Institute');

					const dateElement = findElementByText('p', 'Date created');
					if (dateElement) dateElement.textContent = translate('Date created: May 21, 2025');

					const introElement = findElementByText('p', 'This Privacy Policy');
					if (introElement) {
						introElement.textContent = translate('This Privacy Policy ("Policy") describes how the Artificial Life Institute (hereinafter "the Institute") handles personal information in accordance with the Act on the Protection of Personal Information and related laws and guidelines in Japan.');
					}

					const article1Title = findElementByText('h3', 'Article 1');
					if (article1Title) article1Title.textContent = translate('Article 1: Compliance with Laws and Regulations');

					const article1Content = findElementByText('p', 'The Institute complies');
					if (article1Content) {
						article1Content.textContent = translate('The Institute complies with the Act on the Protection of Personal Information and all other relevant laws, regulations, and guidelines (hereinafter "Applicable Laws").');
					}
				}

				// Update HTML lang attribute
				document.documentElement.lang = 'jp';
			})
			.catch(error => {
				// Silent error handling
			});
	}
})();
</script>