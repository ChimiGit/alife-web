---
// Header component for ALIFE website
export interface Props {
  lang?: string;
  translations?: any;
}

const { lang = 'en', translations } = Astro.props;
---

<header class="font-['Inter',-apple-system,BlinkMacSystemFont,'Segoe_UI',Roboto,sans-serif] sticky top-0 z-50">

    <!-- Main  header content -->
    <div class="bg-white/20 backdrop-blur-md border-b border-white/30 shadow-sm">
      <div class="max-w-6xl mx-auto px-4 flex justify-between items-center min-h-20">
      <!-- Logo section -->
      <div class="flex items-center">
        <a href="/" class="flex items-center" aria-label="ALIFE - Artificial Life Institute">
          <img src="/assets/logo/logo.png" alt="ALIFE Logo" class="h-8 w-32"/>
        </a>
      </div>

      <!-- Navigation section -->
      <nav class="flex items-center gap-8" role="navigation" aria-label="Main navigation">
        <ul class="flex list-none m-0 p-0 gap-8">
          <li class="m-0">
            <a href={`/?lang=${lang}`} class="nav-link no-underline text-primary font-normal text-sm transition-all duration-200 hover:text-accent-cyan relative" data-page="home">Home</a>
          </li>
          <li class="m-0">
            <a href={`/about?lang=${lang}`} class="nav-link no-underline text-primary font-normal text-sm transition-all duration-200 hover:text-accent-cyan relative" data-page="about">{translations?.navigation?.about || 'About'}</a>
          </li>
          <li class="m-0">
            <a href={`/career?lang=${lang}`} class="nav-link no-underline text-primary font-normal text-sm transition-all duration-200 hover:text-accent-cyan relative" data-page="career">{translations?.navigation?.career || 'Career'}</a>
          </li>
          <li class="m-0">
            <a href={`/blog?lang=${lang}`} class="nav-link no-underline text-primary font-normal text-sm transition-all duration-200 hover:text-accent-cyan relative" data-page="blog">{translations?.navigation?.blog || 'Blog'}</a>
          </li>
          <li class="m-0">
            <a href={`/support?lang=${lang}`} class="nav-link no-underline text-primary font-normal text-sm transition-all duration-200 hover:text-accent-cyan relative" data-page="support">{translations?.navigation?.support || 'Support Us'}</a>
          </li>
        </ul>

        <!-- Language selector -->
        <div class="flex items-center gap-2" id="language-selector">
          <span class="w-px h-4 bg-gray-300"></span>
          <a href="?lang=en" class="no-underline font-medium text-xs transition-colors duration-200 hover:text-accent-cyan text-primary" aria-label="English" data-lang="en">EN</a>
          <span class="w-px h-4 bg-gray-300"></span>
          <a href="?lang=jp" class="no-underline font-medium text-xs transition-colors duration-200 hover:text-accent-cyan text-primary" aria-label="Japanese" data-lang="jp">JP</a>
        </div>
      </nav>
      </div>
    </div>
</header>

<style>
  .nav-link {
    position: relative;
  }

  .nav-link::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: #1a365d; /* primary color */
    transition: width 0.3s ease;
  }

  .nav-link.active::after {
    width: 100%;
  }

  .nav-link.active {
    color: #1a365d !important; /* primary color */
    font-weight: 600;
  }

  .nav-link:hover::after {
    width: 100%;
  }
</style>

<script>
  // Language switching functionality
  document.addEventListener('DOMContentLoaded', () => {
    const languageSelector = document.getElementById('language-selector');
    if (!languageSelector) return;

    // Get current language from URL or default to English
    const getCurrentLang = () => {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('lang') || 'en';
    };

    // Update active language styling
    const updateActiveLanguage = () => {
      const currentLang = getCurrentLang();
      const langLinks = languageSelector?.querySelectorAll('a[data-lang]');

      langLinks?.forEach((link) => {
        const lang = link.getAttribute('data-lang');
        if (lang === currentLang) {
          link.classList.add('text-accent-cyan');
          link.classList.remove('text-primary');
        } else {
          link.classList.remove('text-accent-cyan');
          link.classList.add('text-primary');
        }
      });
    };

    // Handle language switching
    languageSelector.addEventListener('click', (e) => {
      const target = e.target as HTMLElement;
      if (target && target.tagName === 'A' && target.hasAttribute('data-lang')) {
        e.preventDefault();
        const newLang = target.getAttribute('data-lang');
        if (newLang) {
          const currentUrl = new URL(window.location.href);
          currentUrl.searchParams.set('lang', newLang);
          window.location.href = currentUrl.toString();
        }
      }
    });

    // Initialize active language styling
    updateActiveLanguage();

    // Navigation active state functionality
    const updateActiveNavigation = () => {
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('.nav-link');
      
      navLinks.forEach((link) => {
        const linkElement = link as HTMLElement;
        const page = linkElement.getAttribute('data-page');
        
        // Remove active class from all links
        linkElement.classList.remove('active');
        
        // Add active class to current page
        if (currentPath === '/' && page === 'home') {
          linkElement.classList.add('active');
        } else if (currentPath.includes(`/${page}`)) {
          linkElement.classList.add('active');
        }
      });
    };

    // Initialize active navigation styling
    updateActiveNavigation();
  });
</script>
