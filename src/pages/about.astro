---
import '../styles/global.css';
import Header from '../components/Header.astro';
import History from '../components/History.astro';
import Mission from '../components/Mission.astro';
import WhoWeAre from '../components/WhoWeAre.astro';
import AboutUsLoading from '../components/loader/AboutUsLoading.astro';
import LanguageSwitcher from '../components/LanguageSwitcher.astro';

// Default language on server side, will be updated client-side
const lang = 'en';
const translations = {
  en: { navigation: { about: "About", career: "Career", blog: "Blog", support: "Support Us" } },
  jp: { navigation: { about: "概要", career: "キャリア", blog: "ブログ", support: "サポート" } }
};

const t = translations[lang as keyof typeof translations] || translations.en;

---

<html lang="en">
	<head>
		<meta charset="utf-8" />	
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>About Us - ALIFE</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	</head>
	<body class="min-h-screen bg-gray-50">
		<!-- Loading Screen -->
		<div id="loading-screen" class="fixed inset-0 z-50 transition-all duration-700 ease-in-out">
			<AboutUsLoading />
		</div>
		
		<!-- Main Content (Hidden Initially) -->
		<div id="main-content" class="opacity-0 transition-opacity duration-500 ease-in hidden">
			<Header lang={lang} translations={t} />
			<!-- Main content -->
			<main class="max-w-4xl mx-auto px-4 py-12" style="font-family: 'Inter', sans-serif;">
			<!-- Tabs Section -->
			<div class="mb-4">
				<div class="sticky top-0 bg-gray-50 py-4 z-40">
					<nav class="flex items-center justify-center" aria-label="Tabs" role="tablist" aria-orientation="horizontal">
						<button type="button" class="active py-4 px-4 inline-flex items-center gap-x-2 border-b-2 border-primary text-sm whitespace-nowrap text-primary font-semibold hover:text-primary focus:outline-hidden focus:text-primary disabled:opacity-50 disabled:pointer-events-none" id="tabs-with-underline-item-1" aria-selected="true" data-hs-tab="#tabs-with-underline-1" aria-controls="tabs-with-underline-1" role="tab">
							About
						</button>
						<div class="h-6 w-px bg-gray-300 mx-2"></div>
						<button type="button" class="py-4 px-4 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-primary focus:outline-hidden focus:text-primary disabled:opacity-50 disabled:pointer-events-none" id="tabs-with-underline-item-2" aria-selected="false" data-hs-tab="#tabs-with-underline-2" aria-controls="tabs-with-underline-2" role="tab">
							History
						</button>
						<div class="h-6 w-px bg-gray-300 mx-2"></div>
						<button type="button" class="py-4 px-4 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-primary focus:outline-hidden focus:text-primary disabled:opacity-50 disabled:pointer-events-none" id="tabs-with-underline-item-3" aria-selected="false" data-hs-tab="#tabs-with-underline-3" aria-controls="tabs-with-underline-3" role="tab">
							Mission
						</button>
					</nav>
				</div>

				<div class="mt-15">
					<div id="tabs-with-underline-1" role="tabpanel" aria-labelledby="tabs-with-underline-item-1">
						<WhoWeAre/>	
					</div>
					<div id="tabs-with-underline-2" class="hidden" role="tabpanel" aria-labelledby="tabs-with-underline-item-2">
						<History/>
					</div>
					<div id="tabs-with-underline-3" class="hidden" role="tabpanel" aria-labelledby="tabs-with-underline-item-3">
						<Mission/>
					</div>
				</div>
			</div>
		</main>

		<!-- Tab functionality script -->
		<script>
			document.addEventListener('DOMContentLoaded', function() {
				const tabs = document.querySelectorAll('[role="tab"]');
				const tabPanels = document.querySelectorAll('[role="tabpanel"]');

				tabs.forEach(tab => {
					tab.addEventListener('click', function() {
						const targetId = tab.getAttribute('data-hs-tab');
						const targetPanel = targetId ? document.querySelector(targetId) : null;
						
						// Remove active state from all tabs
						tabs.forEach(t => {
							t.classList.remove('active', 'font-semibold', 'text-primary', 'border-primary');
							t.classList.add('text-gray-500', 'border-transparent');
							t.setAttribute('aria-selected', 'false');
						});
						
						// Hide all tab panels
						tabPanels.forEach(panel => {
							panel.classList.add('hidden');
						});
						
						// Add active state to clicked tab
						tab.classList.add('active', 'font-semibold', 'text-primary', 'border-primary');
						tab.classList.remove('text-gray-500', 'border-transparent');
						tab.setAttribute('aria-selected', 'true');
						
						// Show target panel
						if (targetPanel) {
							targetPanel.classList.remove('hidden');
						}
					});
				});
			});

			// Loading screen slide-up animation
			setTimeout(function() {
				const loadingScreen = document.getElementById('loading-screen');
				const mainContent = document.getElementById('main-content');
				
				if (loadingScreen && mainContent) {
					// Slide loading screen upward using CSS class
					loadingScreen.classList.add('loading-slide-up');
					
					setTimeout(function() {
						if (loadingScreen && mainContent) {
							// Hide loading screen and show main content
							loadingScreen.classList.add('hidden');
							mainContent.classList.remove('hidden');
							
							// Fade in main content
							setTimeout(function() {
								if (mainContent) {
									mainContent.classList.remove('opacity-0');
									mainContent.classList.add('opacity-100');
								}
							}, 50);
						}
					}, 700);
				}
			}, 2500); // Show loading for 2.5 seconds
		</script>
		</div>
		</main>
		</div>
		
		<!-- Universal language switching -->
		<LanguageSwitcher />
	</body>
</html>
